---
title: "ML.NET Tutorial: Getting started with ML.NET"
category: Machine Learning
datePublished: "2019-08-02"
dateCreated: "2019-08-02"
---

<p>Microsoft built a new machine learning library a while ago. It allows C# engineers that want to take their machine learning to a higher level to build custom models rather than using the standard cognitive services. In this post I'll show you how to get started.</p><p>Since some people don't like to read, I've also created a short video demonstrating how to get started with ML.NET.</p><figure class="kg-card kg-embed-card"><iframe width="480" height="270" src="https://www.youtube.com/embed/6udPLZR0vvQ?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>In this post we'll cover the following topics:</p><ul><li>What is ML.NET?</li><li>Installing the ML.NET commandline utilities</li><li>Building your first machine learning model</li></ul><h2 id="what-is-ml-net">What is ML.NET?</h2><p>ML.NET is a library and a set of tools that allow .NET developers to build and integrate machine learning into their .NET application.</p><p>With ML.NET, you can create regression, classification, recommendation, and forecasting models in C#.</p><p>You can build machine learning models in ML.NET using code, or you can automatically generate them using the command line tools. In this post we're focusing in on the automated machine learning tools, I will get back to the code in a future post.</p><h2 id="installing-the-ml-net-commandline-utilities">Installing the ML.NET commandline utilities</h2><p>To get started with automated machine learning in ML.NET, you'll need the command line utility or Visual Studio. The command-line tool can be installed using the following command:</p><pre><code>dotnet tool install -g mlnet</code></pre><p>Make sure you have .NET core 2.2 or later installed on your machine before running this command. If you haven't got it yet, you can get it from the website: <a href="https://dot.net/">https://dot.net/</a></p><p><strong>Tip: </strong>If you've tried ML.NET before, you may run into an error telling you that the tool is already installed. In this case, run <code>dotnet tool uninstall mlnet</code> to install the old version. Then, run the original install command to get the updated version of the tool.</p><p><strong>For mac users: </strong>I ran into a problem where the tool did install, but couldn't be found in the <code>$PATH</code> variable of my system. I extended my `$PATH` to include the .NET tools like so:</p><pre><code>export PATH=$PATH:~/.dotnet/tools/</code></pre><p>After this, the tool worked like a charm!</p><p>Let's move on to building our first machine learning model.</p><h2 id="building-your-first-machine-learning-model">Building your first machine learning model</h2><p>With the tools installed, let's jump into creating a machine learning model. We're going to use a toy dataset for this from the UCI machine learning repository. After we've downloaded the data and transformed it to CSV, we're going to use the ML.NET command-line tool to train a model.</p><h3 id="getting-sample-data-from-the-uci-machine-learning-repository">Getting sample data from the UCI machine learning repository</h3><p>First, we need to download a dataset. You can get some pretty cool datasets from the UCI machine learning repository: <a href="https://archive.ics.uci.edu/ml/datasets.php">https://archive.ics.uci.edu/ml/datasets.php</a></p><p>Among the samples is a dataset that can be used to train a regression model to predict the milage of a car based on its properties. You can get it here: <a href="https://archive.ics.uci.edu/ml/datasets/Auto+MPG">https://archive.ics.uci.edu/ml/datasets/Auto+MPG</a></p><p>You'll find that the dataset is stored in a weird format. I've gone ahead and converted it to CSV using Python. You can get the CSV file from my github account: <a href="https://gist.github.com/wmeints/80c1ba22ceeb7a29a0e5e979f0b0afba">https://gist.github.com/wmeints/80c1ba22ceeb7a29a0e5e979f0b0afba</a></p><h3 id="using-the-ml-net-commandline-utility">Using the ML.NET commandline utility</h3><p>With the dataset we can train a ML.NET machine learning model using the following command:</p><pre><code>mlnet auto-train --task regression --dataset auto-mpg.csv --label-column-index 0 -x 30</code></pre><p>This command takes the following parameters:</p><ul><li>--task: The task (regression, classification, recommendation, forecasting)</li><li>--dataset: The path to the dataset</li><li>--label-column-index: The index of the column that we want to predict</li><li>-x: The amount of time spend exploring different models</li></ul><p>I've set the time to explore really low (30 seconds) for demonstration purposes. Depending on your dataset you will need more time to get a good model.</p><h3 id="exploring-the-generated-output">Exploring the generated output</h3><p>Once the command line tool is done, it will generate a sample project and a model project for you. The image below shows what the project looks like in Visual Studio Code.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="/content/images/2019/08/2019-08-02_09-09-24.png" class="kg-image"><figcaption>The generated projects in Visual Studio Code</figcaption></figure><p>There are two projects in the solution:</p><ol><li>The model project, which contains the trained model.</li><li>A sample console application, demonstrating the use of the model project.</li></ol><p>The easiest way to get the model into your project is to copy the sources of the model project to your own application and use the console application as a template to write the necessary glue code.</p><h2 id="summary">Summary</h2><p>In this post you saw how to get started with ML.NET and where to get free sample datasets to start learning. In the next post we'll explore the pipeline further and learn how to build a machine learning model without automated machine learning tools.</p><p>Thanks for reading!</p>
